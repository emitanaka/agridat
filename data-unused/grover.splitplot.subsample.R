# grover.splitplot.subsample.R

# Reason not used: ?

# This is an interesting example of split-plot experiment with subsampling.
# Similar to other

# Source: 
# Experimental Designing And Data Analysis In Agriculture And Biology
# by Deepak Grover, Lajpat Rai
# Page 88-89.

height <- c(102.5,90.5,94.5,93.5,104.8,95.8,95,100.5,110.5,95.6,93.5,100,96,100.3,99.7,105.8,96.5,94,90,90,102.5,99.5,90.3,108.9,108.3,89.6,93.5,104.9,100,95,95.8,112.8,
108.5,89.6,93.6,91.3,102.3,107.9,93,112.3,108.4,97.8,91.7,105,98,95.8,101.8,106.8,94.5,93,91.8,91.3,103.5,98.6,91.3,110,110,90.5,99.6,107.8,101.3,96,97.8,113.8,
113.2,115.4,110.5,109.7,108.6,100.4,98,119.5,115.6,120.5,107,116,108.8,109.7,98.6,109.9,108.9,108.9,108.9,106.3,98.6,101.5,96.1,111.3,106.8,116,115.6,105.6,116.5,101.5,100.8,95.8,
107.5,110.8,115.8,104.6,100.9,110.5,100.8,104.6,106,116.7,104.6,117,106.6,111.5,99.5,106.8,110.5,110.5,109.6,108.5,99.5,101,94.2,113.4,105.7,121.5,117.8,116.9,119.6,102.8,100.9,94.3,
110.3,106.9,104.9,110.8,102.7,103.8,104.9,97.5,115.9,101.3,116.8,108,118.3,118.9,101.5,108.4,116.5,109.3,110.5,112.3,93.4,111.3,100,100,118,93.4,119.2,121.5,126.8,120.3,111.5,112.5,
105.9,104.3,106.9,106.9,96.8,109.6,116.9,100.3,108.7,105,123,110,116.9,122.5,105.6,110.3,118,105.6,114.3,114.9,95.6,109.8,98.6,98,115.6,101.5,121.5,124.6,127.6,121.8,116.5,114.9)

sum(height)

dat <- data.frame(height=height,
                  time=rep(c("T1","T2","T3","T4"), each=8),
                  manage=paste0("M", c(1:8)),
                  block=rep(c("R1","R2","R3"), each=64),
                  sample=rep(c("S1","S2"), each=32))


# Match anova table of Grover, page 92
anova(aov(height ~ block + manage + block:manage + time + time:manage +
##             block:time:manage, data=dat))
##                   Df Sum Sq Mean Sq  F value    Pr(>F)    
## block              2 4414.9 2207.46 225.0414 < 2.2e-16 ***
## manage             7 1211.7  173.10  17.6473 7.422e-15 ***
## time               3 1076.9  358.96  36.5945 7.398e-16 ***
## block:manage      14 3053.5  218.10  22.2349 < 2.2e-16 ***
## manage:time       21  981.3   46.73   4.7636 5.865e-08 ***
## block:manage:time 48 3315.2   69.07   7.0410 3.455e-16 ***
## Residuals         96  941.7    9.81                       
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
